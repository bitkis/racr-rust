## Board Generation
A board can be generated by chosing a unit together with other memory mapped peripheerals and peripherals attached to different interfaces.

## Unit Generation
Units can be generated by placing peripherals at specific addresses. This section defines how units are defined.

### Unit
| Element            | Type                     |  Condition     | Description  |
| ------------------ | ------------------------ | -------------- | ------------ |
| identifier         | String                   | required       |              |
| description        | String                   | optional       |              |
| peripherals        | [PeripheralInstance]     | 0+             |              |

### PeripheralInstance
| Element            | Type                     |  Condition     | Description  |
| ------------------ | ------------------------ | -------------- | ------------ |
| peripheral         | String                   | required       | The identifier of the peripheral that is being istanciated |
| name_postfix       | String                   | required       | The full name will be `<peripheral:to_snake_case><name_postfix>` |
| address            | uint                     | required       | The address where the peripheral is being instanciated  |



## Peripheral Generation
Peripherals will be generated as data types even if they are never used anywhere. This section defines how peripherals are specified in RACR.

### Peripheral

| Element            | Type                     |  Condition     | Description  |
| ------------------ | ------------------------ | -------------- | ------------ |
| identifier         | String                   | required       |              |
| description        | String                   | optional       |              |
|||||
| memory_mapped      | bool                     | required       | A memory mapped (internal) peripheral will generate a struct with the correct memory layout. Set to false if access code should be generated instead (in case of SPI, I2C, etc access) |
|||||
| registers          | [Register]               | 0+             |              |

### Register
| Element            | Type                     |  Condition     | Description  |
| ------------------ | ------------------------ | -------------- | ------------ |
| name               | String                   | required       |              |
| description        | String                   | optional       |              |
|||||
| offset             | uint                     | required       | Offset from the peripheral base address |
| size               | uint                     | required       | Length in bits of the register representation, used for detecting out of bound fields | 
| array_length       | uint                     | optional       | If specified, this register will be made into several identical registers |
| overlapping        | bool                     | required       | If true, it allows other registers to overlap with this even if they both are read or both are write |
|||||
| access             | [Access]                   | required       | `ReadOnly`, `WriteOnly` or `ReadWrite`. A `WriteOnly`(`ReadOnly`) Register is allowed to overlap with `ReadOnly`(`WriteOnly`) registers even if overlapping is `false` |
| reset_value        | uint                     | optional       | If no reset value is specified it will be assumed that the reset value is undefined |
|||||
| fields             | [Field]                  | 0+             |              |

### Field
| Element            | Type                     |  Condition     | Description  |
| ------------------ | ------------------------ | -------------- | ------------ |
| name               | String                   | required       |              |
| description        | String                   | optional       |              |
|||||
| bit_offset         | uint                     | required       | The starting bit of this register |
| size               | uint                     | required       | Length in bits of the field |
|||||
| access             | [Access]                   | required       | `ReadOnly`, `WriteOnly` or `ReadWrite`. A `WriteOnly`(`ReadOnly`) field is allowed to overlap with `ReadOnly`(`WriteOnly`) fields.

## Common
### Access
#### Definition
Access can be one of the following variants:
 - `ReadOnly`
 - `WriteOnly`
 - `ReadWrite`

#### Access rules
Some rules exists related to `Access`
 - If a `Register` is `WriteOnly` then all its fields must also be `WriteOnly`.
 - If a `Register` is `ReadOnly` then all its fields must also be `ReadOnly`.


[Access]: https://github.com/kjetilkjeka/racr-format/master/specification#access
